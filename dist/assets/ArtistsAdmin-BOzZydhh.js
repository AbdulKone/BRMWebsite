import{d as oe,b as ne,j as e,X as y,g as de,U as w,e as R,I as ce,C as z,v as me,s as F}from"./index-DN8h3Y9b.js";import{r as a}from"./react-vendor-VkFUI6JC.js";import{C as O}from"./ConfirmDialog-BT3SwRyR.js";import{A as ue,P as xe,D as ge}from"./DragDropReorder-Czt_8iWJ.js";import{m as c}from"./ui-vendor-jY-liuQK.js";import{P as q}from"./save-CY1Hemzt.js";import{T as pe}from"./trash-2-BwtB9nAO.js";import{U as he}from"./upload-t_bHCpCi.js";const ke=()=>{const{artists:i,createArtist:H,updateArtist:h,deleteArtist:L}=oe(),{handleError:m,handleSuccess:x}=ne(),[b,o]=a.useState("list"),[u,C]=a.useState(!1),[f,A]=a.useState(null),[l,n]=a.useState({}),[k,j]=a.useState(null),[$,v]=a.useState(!1),[D,S]=a.useState(null),[G,_]=a.useState(!1),[E,g]=a.useState(null),[M,I]=a.useState(!1),[P,V]=a.useState(!1),[B,N]=a.useState(!1),X=i.length,Y=i.filter(s=>{const t=new Date(s.release_date),r=new Date;return r.setMonth(r.getMonth()-6),t>=r}).length,J=s=>{if(s.target.files&&s.target.files[0]){const t=s.target.files[0],r=me(t);if(r){m(r);return}j(t);const d=new FileReader;d.onloadend=()=>{g(d.result)},d.readAsDataURL(t)}},Q=async s=>{var t;I(!0);try{const r=Date.now(),d=Math.random().toString(36).substring(2,15),le=(t=s.name.split(".").pop())==null?void 0:t.toLowerCase(),U=`artists/${`${r}-${d}.${le}`}`,{error:ae}=await F.storage.from("media").upload(U,s,{cacheControl:"3600",contentType:s.type,upsert:!1});if(ae)throw new Error("Erreur lors de l'upload de l'image");const{data:{publicUrl:ie}}=F.storage.from("media").getPublicUrl(U);return ie}catch(r){throw m(r,"Erreur lors de l'upload de l'image"),new Error("Erreur lors de l'upload de l'image")}finally{I(!1)}},W=async s=>{s.preventDefault();try{if(!l.name||!l.description||!l.latest_work||!l.release_date)throw new Error("Veuillez remplir tous les champs obligatoires");let t=l.image_url;if(k)t=await Q(k);else if(!f&&!t)throw new Error("Une image est requise");const r={...l,image_url:t};f?(await h(f,r),x("Artiste mis à jour avec succès")):(await H(r),x("Artiste créé avec succès")),p(),o("list")}catch(t){m(t,"Erreur lors de la sauvegarde de l'artiste")}},K=s=>{A(s.id),n(s),g(s.image_url||null),C(!0),o("form")},Z=s=>{S(s),v(!0)},ee=async()=>{D&&(await L(D),S(null),v(!1))},p=()=>{n({}),j(null),g(null),A(null),C(!1)},T=()=>{p(),o("form")},se=a.useCallback(async s=>{try{const t=s.map((r,d)=>h(r.id,{display_order:d}));await Promise.all(t),N(!1),x("Ordre des artistes mis à jour avec succès")}catch(t){m(t,"Erreur lors de la réorganisation des artistes")}},[h,m,x]),te=a.useCallback(s=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-800/50 rounded-lg",children:[s.image_url&&e.jsx("img",{src:s.image_url,alt:s.name,className:"w-12 h-12 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-white",children:s.name}),e.jsx("p",{className:"text-sm text-gray-400",children:s.latest_work})]})]}),[]),re=[{id:"list",label:"Liste des Artistes",icon:w},{id:"form",label:u?"Modifier Artiste":"Nouvel Artiste",icon:q}];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-900/20 via-blue-900/20 to-indigo-900/20 border-b border-gray-800",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-400 via-blue-400 to-indigo-400 bg-clip-text text-transparent",children:"Gestion des Artistes"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Gérez votre roster d'artistes et leurs dernières sorties"})]}),e.jsx("button",{onClick:()=>V(!P),className:"md:hidden p-2 rounded-lg bg-gray-800 text-gray-300 hover:text-white hover:bg-gray-700 transition-colors",children:P?e.jsx(y,{className:"w-6 h-6"}):e.jsx(de,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[e.jsx(c.div,{className:"bg-gradient-to-r from-purple-600/20 to-purple-800/20 backdrop-blur-sm border border-purple-500/20 rounded-xl p-4",whileHover:{scale:1.02},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-300 text-sm font-medium",children:"Total Artistes"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:X})]}),e.jsx(w,{className:"w-8 h-8 text-purple-400"})]})}),e.jsx(c.div,{className:"bg-gradient-to-r from-blue-600/20 to-blue-800/20 backdrop-blur-sm border border-blue-500/20 rounded-xl p-4",whileHover:{scale:1.02},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-300 text-sm font-medium",children:"Sorties Récentes"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:Y})]}),e.jsx(R,{className:"w-8 h-8 text-blue-400"})]})}),e.jsx(c.div,{className:"bg-gradient-to-r from-indigo-600/20 to-indigo-800/20 backdrop-blur-sm border border-indigo-500/20 rounded-xl p-4",whileHover:{scale:1.02},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-300 text-sm font-medium",children:"Avec Images"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:i.filter(s=>s.image_url).length})]}),e.jsx(ce,{className:"w-8 h-8 text-indigo-400"})]})}),e.jsx(c.div,{className:"bg-gradient-to-r from-green-600/20 to-green-800/20 backdrop-blur-sm border border-green-500/20 rounded-xl p-4",whileHover:{scale:1.02},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-300 text-sm font-medium",children:"Cette Année"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:i.filter(s=>new Date(s.release_date).getFullYear()===new Date().getFullYear()).length})]}),e.jsx(z,{className:"w-8 h-8 text-green-400"})]})})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-6",children:re.map(s=>{const t=s.icon,r=b===s.id;return e.jsxs("button",{onClick:()=>{o(s.id),s.id==="form"&&!u&&p()},className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${r?"bg-gradient-to-r from-purple-600 to-blue-600 text-white shadow-lg":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white"}`,children:[e.jsx(t,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:s.label})]},s.id)})})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[b==="list"&&e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Liste des Artistes"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>N(!0),className:"flex items-center gap-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-4 py-2 rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-all duration-200 shadow-lg",children:[e.jsx(ue,{className:"w-4 h-4"}),"Réorganiser"]}),e.jsxs("button",{onClick:T,className:"flex items-center gap-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white px-4 py-2 rounded-lg hover:from-purple-700 hover:to-blue-700 transition-all duration-200 shadow-lg",children:[e.jsx(q,{className:"w-4 h-4"}),"Nouvel Artiste"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(s=>e.jsxs(c.div,{className:"bg-gradient-to-br from-gray-800/50 to-gray-900/50 backdrop-blur-sm border border-gray-700/50 rounded-xl overflow-hidden hover:border-purple-500/50 transition-all duration-300",whileHover:{scale:1.02,y:-5},layout:!0,children:[s.image_url&&e.jsx("div",{className:"aspect-video overflow-hidden",children:e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:s.name}),e.jsx("p",{className:"text-gray-400 text-sm mb-3 line-clamp-2",children:s.description}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(R,{className:"w-4 h-4 text-purple-400"}),e.jsx("span",{className:"text-gray-300",children:s.latest_work})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(z,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"text-gray-300",children:new Date(s.release_date).toLocaleDateString("fr-FR")})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>K(s),className:"flex-1 flex items-center justify-center gap-2 bg-blue-600/20 text-blue-400 px-3 py-2 rounded-lg hover:bg-blue-600/30 transition-colors",children:[e.jsx(xe,{className:"w-4 h-4"}),"Modifier"]}),e.jsxs("button",{onClick:()=>Z(s.id),className:"flex-1 flex items-center justify-center gap-2 bg-red-600/20 text-red-400 px-3 py-2 rounded-lg hover:bg-red-600/30 transition-colors",children:[e.jsx(pe,{className:"w-4 h-4"}),"Supprimer"]})]})]})]},s.id))}),i.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(w,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"Aucun artiste"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Commencez par ajouter votre premier artiste"}),e.jsx("button",{onClick:T,className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white px-6 py-3 rounded-lg hover:from-purple-700 hover:to-blue-700 transition-all duration-200",children:"Ajouter un Artiste"})]})]}),b==="form"&&e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-gradient-to-br from-gray-800/50 to-gray-900/50 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:u?"Modifier l'Artiste":"Nouvel Artiste"}),e.jsx("button",{onClick:()=>o("list"),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(y,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:W,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Nom de l'artiste *"}),e.jsx("input",{type:"text",value:l.name||"",onChange:s=>n({...l,name:s.target.value}),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors",placeholder:"Nom de l'artiste",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Dernière sortie *"}),e.jsx("input",{type:"text",value:l.latest_work||"",onChange:s=>n({...l,latest_work:s.target.value}),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors",placeholder:"Titre de la dernière sortie",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description *"}),e.jsx("textarea",{value:l.description||"",onChange:s=>n({...l,description:s.target.value}),rows:4,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors resize-none",placeholder:"Description de l'artiste...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Date de sortie *"}),e.jsx("input",{type:"date",value:l.release_date||"",onChange:s=>n({...l,release_date:s.target.value}),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-lg text-white focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Image de l'artiste"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-600 border-dashed rounded-lg cursor-pointer bg-gray-800/30 hover:bg-gray-700/30 transition-colors",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(he,{className:"w-8 h-8 mb-2 text-gray-400"}),e.jsxs("p",{className:"text-sm text-gray-400",children:[e.jsx("span",{className:"font-semibold",children:"Cliquez pour uploader"})," ou glissez-déposez"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, WEBP (MAX. 5MB)"})]}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:J})]})}),E&&e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:E,alt:"Prévisualisation",className:"w-full h-48 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{g(null),j(null),u&&n({...l,image_url:""})},className:"absolute top-2 right-2 p-1 bg-red-600 text-white rounded-full hover:bg-red-700 transition-colors",children:e.jsx(y,{className:"w-4 h-4"})})]})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>o("list"),className:"flex-1 px-6 py-3 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Annuler"}),e.jsx("button",{type:"submit",disabled:M,className:"flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:from-purple-700 hover:to-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:M?"Upload en cours...":u?"Mettre à jour":"Créer"})]})]})]})})]}),e.jsx(O,{isOpen:$,onClose:()=>v(!1),onConfirm:ee,title:"Supprimer l'artiste",message:"Êtes-vous sûr de vouloir supprimer cet artiste ? Cette action est irréversible.",confirmText:"Supprimer",cancelText:"Annuler"}),e.jsx(O,{isOpen:G,onClose:()=>_(!1),onConfirm:()=>{p(),o("list"),_(!1)},title:"Abandonner les modifications",message:"Vous avez des modifications non sauvegardées. Voulez-vous vraiment quitter ?",confirmText:"Quitter",cancelText:"Continuer l'édition"}),e.jsx(ge,{items:i,onReorder:se,renderItem:te,getItemId:s=>s.id,title:"les Artistes",isOpen:B,onClose:()=>N(!1)})]})};export{ke as default};
//# sourceMappingURL=ArtistsAdmin-BOzZydhh.js.map
